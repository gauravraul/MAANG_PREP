# Medium System Design Questions & Answers – Set 2

## 1. Design a Parking Lot System
**Question:** How would you design a parking lot management system that supports different vehicle sizes and payment processing?

**Answer:**  
- **Entities:** ParkingSpot (Small/Medium/Large), Vehicle, Ticket, Payment, Entrance/Exit gates.  
- **Flow:**  
  1. Vehicle enters, gate scans license plate.  
  2. Allocate nearest available spot based on size.  
  3. Generate ticket with timestamp.  
  4. Payment at exit (cash, card, online).  
- **Storage:** Maintain `Spot` table with occupancy status.  
- **Scaling:** Multiple gates, load balancer for API requests, distributed database.

---

## 2. Design a Notification Service
**Question:** How to design a service that sends notifications (Email, SMS, Push) to millions of users?

**Answer:**  
- **Architecture:**  
  - Producer (App) → Queue (Kafka/SQS) → Worker Service → Channel-specific Gateway (SMTP, Twilio, Firebase).  
- **Key Points:**  
  - Use message queues for decoupling.  
  - Retry failed deliveries.  
  - Use templates for personalization.  
  - Horizontal scaling of workers.  

---

## 3. Design an Online Polling System
**Question:** Design a real-time online voting/polling system.

**Answer:**  
- **Requirements:** Multiple polls, real-time results, prevent duplicate voting.  
- **Tech:**  
  - Backend: WebSockets for live updates.  
  - DB: Redis for storing and counting votes quickly.  
  - User authentication to prevent duplicate votes.  
- **Scaling:** Use sharding for very large vote counts.

---

## 4. Design a News Feed System
**Question:** How to design the feed for a social media platform?

**Answer:**  
- **Flow:**  
  1. Fetch recent posts from friends/followed users.  
  2. Rank based on relevance, recency, engagement.  
  3. Cache results for faster reloads.  
- **Storage:** Post table, user graph table.  
- **Scaling:** Use fan-out on write for small users, fan-out on read for large followings.

---

## 5. Design a Rate Limiter
**Question:** How to design a service that limits API requests per user?

**Answer:**  
- **Algorithms:** Token Bucket, Leaky Bucket, Fixed Window, Sliding Window.  
- **Implementation:**  
  - Use Redis with expiry to store request counts.  
  - Middleware checks before processing request.  
- **Scaling:** Redis Cluster for high availability.

---

## 6. Design a Chat Room Service
**Question:** How to design a multi-room chat service like Slack?

**Answer:**  
- **Flow:**  
  1. Users join rooms via WebSocket connections.  
  2. Messages go through message broker (Kafka, RabbitMQ).  
  3. Persist messages in database.  
- **Scaling:** Partition rooms across servers, use load balancers, store messages in NoSQL.

---

## 7. Design an Event Ticket Booking System
**Question:** How to design a concert ticket booking system?

**Answer:**  
- **Challenges:** Avoid overselling, handle high concurrency.  
- **Solution:**  
  - Lock inventory in Redis when checkout starts.  
  - Confirm booking after payment.  
  - Release lock if payment fails.  
- **Scaling:** Use CDN for event listings, distributed DB for bookings.

---

## 8. Design a Document Collaboration Tool
**Question:** How to design Google Docs-style live collaboration?

**Answer:**  
- **Approach:** Operational Transformation (OT) or Conflict-free Replicated Data Types (CRDT).  
- **Flow:**  
  - Client edits → Server merges → Broadcast to other clients.  
  - Maintain document versions.  
- **Scaling:** Use WebSockets, shard by document ID.

---

## 9. Design a Short URL Service
**Question:** How to design bit.ly-like URL shortening service?

**Answer:**  
- **Flow:**  
  1. Accept long URL, generate short hash.  
  2. Store mapping in DB.  
  3. Redirect on access.  
- **Scaling:** Use base62 encoding, Redis caching, CDN for static redirects.

---

## 10. Design a Payment Gateway
**Question:** How to design a system that processes payments securely?

**Answer:**  
- **Flow:**  
  1. Merchant sends transaction request.  
  2. Validate payment details.  
  3. Call bank APIs for authorization.  
  4. Return status to merchant.  
- **Security:** PCI-DSS compliance, tokenization, HTTPS everywhere.  
- **Scaling:** Queue failed transactions for retry.

---
