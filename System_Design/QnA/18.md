# System Design Interview Q&A – Set 10 (Legendary / CTO-Level Problems)

---

## Q1: Design a Distributed, Adaptive Priority Queue System for ML Workloads

### Answer:

### Requirements:
- Multiple producers
- Priority-based ordering (e.g., high-priority ML jobs)
- Dynamic priority updates
- No global locking

### Architecture:
Producers → Priority Queue Shards → Scheduler → Workers

### Core Concepts:
- Partition queue by `priority bucket`
- Each bucket internally ordered by sequence number
- Bucket-level weighted scheduling

### Dynamic Priority:
- Jobs can move across buckets by:
  - Mark version for new bucket
  - Lazy migration during read
  - Workers skip stale entries

### Scaling:
- Shard buckets horizontally
- Hot buckets → split automatically
- Regional priority schedulers for locality

---

## Q2: Design a Global Data Residency Enforcement Layer (Cross-Cloud)

### Answer:

### Requirements:
- Define rules: which data must stay in region X
- Real-time enforcement
- Transparent to applications
- Multi-cloud aware

### Architecture:
Client → Policy Engine → Data Router → Region-Specific Storage Nodes

### Enforcement Strategies:
- Data tagged with residency policy
- Router chooses correct region
- Move or deny writes that violate policy

### Audit:
- Immutable log of policy access
- Automated region-boundary checks

### Failure Isolation:
- Per-region failover
- Strict mode: block writes
- Permissive mode: queue writes until compliant

---

## Q3: Design a Distributed, Consistent Rate Estimation System (Live Pricing)

### Answer:

### Requirements:
- Calculate price / rate / metrics in real time
- Multiple regional calculators
- Single correct global number

### Architecture:
Regional Calculators → Consensus Layer → Global Price Feed

### Strong Consistency:
- Leader election per metric
- Regional calculators stream updates
- Leader verifies, aggregates, publishes

### Performance:
- Use event batching
- Snapshot state
- Stream deltas

---

## Q4: Design a Hybrid Compute + Storage Engine for Real-Time Feature Engineering

### Answer:

### Requirements:
- Fresh features for ML inference
- Online + offline computation
- Materialization with strict freshness guarantees

### Architecture:
Streaming Layer → Feature Engine → Storage Tier (Online + Offline) → Model Serving

### Tricks:
- Online features stored in Redis / RocksDB
- Backfill features via batch jobs
- TTL + conflict-free write paths

### SLA:
- Sub-20ms feature fetch
- Async propagation for derived features

---

## Q5: Design a Distributed Spatial Index for Real-Time Geo Queries (Uber-Level Complexity)

### Answer:

### Requirements:
- Millions of moving vehicles
- Find nearest N drivers/riders
- Sub-100ms query time

### Architecture:
Geo Updates → Spatial Indexer → Sharded KD-Tree / QuadTree → Query API

### Index Maintenance:
- Partition by geohash prefix
- Real-time updates via streaming
- Cache hot geohash buckets

### Locality:
- Region-based data ownership
- Strong consistency in partition
- Async replication across partitions

---

## Q6: Design a Multi-Tenant, Zero-Downtime Schema Evolution System

### Answer:

### Requirements:
- Schema changes without downtime
- Multi-tenant
- Backward-compatible reads
- Forward-compatible writes

### Strategy:
- Dual-write: old schema + new schema
- Versioned access layer
- Lazy migration per row
- Progressive column backfill workers

### Observability:
- Migration progress KPIs
- Canary schema versions
- Rollback migration at column granularity

---

## Q7: Design a Planet-Scale Remote Feature Toggle System for IoT Devices

### Answer:

### Requirements:
- Push config to devices
- Zero-trust
- Progressive rollout
- Partial connectivity

### Architecture:
Control Plane → Regional Brokers → Edge Device Agents

### Sync Strategy:
- Signed config bundles
- Version monotonicity
- Device-local rollback snapshots

### Offline:
- Apply last-known config
- Retry sync with exponential backoff

---

## Q8: Design a Fully Autonomous Fraud Detection + Protection Mesh

### Answer:

### Requirements:
- Detect fraud
- Auto reclassify risk
- Trigger dynamic policy changes
- Cross-tenant constraints

### Architecture:
Event Streams → Feature Extractor → ML Engine → Risk Controller → Policy Enforcement

### Auto-Protection:
- Dynamic throttling
- Account freeze
- Shadow evaluation mode before enforcement

### SLA:
- Detection in <50ms
- Policy update propagation <2s globally

---

## Q9: Design a Fully Composable Data Infrastructure (Plug/Play Components)

### Answer:

### Requirements:
- Every layer is replaceable: ingestion, ETL, warehouse, stream processor
- Tenant-level isolation
- Schema federated governance

### Architecture:
Data Product Mesh → Mediation Layer → Dynamic Routing → Execution Engine

### Federation:
- Unified metadata model
- Column-level lineage
- Query-time data virtualization

---

## Q10: Design a Cognitive Observability System (Self-Aware Infra)

### Answer:

### Requirements:
- Detect anomalies automatically
- Suggest remediation plans
- Predict cascading incidents
- Explain anomalies

### Architecture:
Metrics/Logs/Traces → Feature Extractor → ML Insight Engine → Action Runner

### Features:
- Multi-signal correlation
- Probabilistic incident scoring
- Confidence-based action gating
- Natural language root cause summaries

---

# Answer Format for “Legendary Level” Interviews

For each question:

1. **Define global invariants**
2. **Explain partitioning strategy**
3. **Describe consistency model and conflict handling**
4. **Explain role of async vs sync flows**
5. **Handle blast radius and graceful degradation**
6. **Add autonomous remediation or ML augmentation**
7. **Quantify approximate latencies / QPS scaling**
8. **Demonstrate migration, lifecycle, and governance**
9. **Incorporate observability + auditability**
10. **Close with cost vs reliability trade-offs**
